# Python cmd SSMS 学生管理系统

HOME PC win11 Python 3.10.1
----.--.--

### 更新内容

* [X] 学生信息批量导入功能
* [X] 学生信息导出到文件功能
* [X] 删除学生支持一次多学号删除

### 新增功能说明

#### 学生信息批量导入

该功能是从 Excel 文件（目前支持 .xls 和 .xlsx 文件）中导入多条学生数据
系统会自动检查文件中的信息错误，例如学号已存在、数据格式不符合要求、学号信息重复等
对于文件中的错误，系统会提示出错单元格位置，并且给出修改建议以及格式要求

**操作流程如下：**

1. 选择文件打开目录（默认路径 or 自定义路径）
2. 选择文件
   * 若为默认路径，选择文件时直接选择输入系统找到的文件名（包含扩展名）
   * 若为自定义路径，系统自动检测输入路径，若为文件夹则列出文件夹中受支持的文件，若为文件则判断该文件是否支持
3. 系统检查文件是否出现错误
4. 选择是否执行导入
   * 若步骤3检查未出错，执行导入会正常导入信息
   * 若步骤3检查出现错误，执行导入会自动跳过出错的信息，仅将完整的正确的信息写入系统
5. 系统输出导入结果

#### 学生信息导出到文件

该功能将系统中的学生信息按照使用者要求导出到 Excel 文件（目前支持 .xls 和 .xlsx 文件）
使用者可以选择导出哪些学生信息，提供了多种选择方式。当筛选完导出信息时系统会将已包括的信息输出，询问使用者是否确认导出
导出的位置为软件默认导出位置，文件名由用户输入或使用系统默认，系统会自动检查文件是否已经存在，并在文件已存在时给出重命名提示

**操作流程如下：**

1. 选择数据筛选方式
   1. 选择所有数据，该方式会导出系统中所有的学生数据
   2. 根据成绩范围选择，提供四种选择方式
      * 输入 `60-80` 会选择成绩在60分到80分之间（包括60和80）的学生数据
      * 输入 `-60` 会选择成绩小于等于60分的学生数据
      * 输入 `80-` 会选择成绩大于等于80分的学生数据
      * 输入 `70` 会选择所有成绩为70分的学生数据
   3. 根据学号选择，此方式可以输入多个学号，中间用空格分割，系统会自动跳过不存在或错误的学号并将这些错误学号输出
2. 系统提示已找到的学生数据
3. 确认数据是否为所需选择是否导出
4. 输入导出文件名
   * 若此处不输入任何数据，则会根据当前系统时间创建拓展名为 .xlsx 的文件
   * 若此处只输入文件名而不包括扩展名，则会自动添加 .xlsx 的扩展名
   * 若此处输入扩展名不为 .xls 或 .xlsx 则系统会提示扩展名错误
   * 若此处输入的文件名已存在，则会提示错误
   * 此处出现任何错误系统都会请求重新命名文件名
5. 建立文件并导出到默认路径，导出完成后系统会将路径输出

### 已知问题&更新预告

* 导入学生信息时由于格式要求，xlsx 文件的编写需要格外小心
* xlsx 文件目前仅支持首行为列名，从第二行开始写数据的格式，暂不具备自动识别数据行数的功能
* 由于导入文件是格式要求必须精确，考虑到使用者事先不了解格式要求，应添加模版导出功能，正在开发中
* 系统目前并未对文件依赖目录进行检查，若文件目录缺失，如存放导出文件的文件夹缺失，可能会导致错误，该问题将在后几个版本解决


![1644329370281.png](image/readme/1644329370281.png)
